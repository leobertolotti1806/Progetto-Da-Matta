import{g as T,a as E,_ as G,p as j,l as A}from"./qEfkgdYJ.js";import{a as F,_ as H}from"./rQgUpoam.js";import{_ as U}from"./DZ_zasnl.js";import{_ as $,r as _,t as c,E as m,v as r,x as n,a9 as O,y as u,F as t,B as y,M as h,I as K,C as q,z as g,D as b,H as L}from"./CX_hZqBa.js";import{_ as Q}from"./Jb0QBs_6.js";import{u as M}from"./B6GcUipP.js";const J={class:"modal-content"},W={class:"modal-body"},X={key:0},Y={key:1},Z={key:2},ee={key:3},te={__name:"myModalPrivacy",props:{show:{type:Boolean,default:!1},pagamenti:{type:Boolean,default:!1}},emits:["close"],setup(z,{emit:v}){const a=_([]),i=v,l=z;return T("https://bertolotti.ct.ws/getParagraphs?page=footer").then(function(s){if(s.ok)a.value=E(s.paragrafi);else{alert("Ricarica la pagina");return}}),(s,o)=>z.show?(r(),c("div",{key:0,class:"modal-overlay",onClick:o[1]||(o[1]=h(k=>i("close"),["self"]))},[n("div",null,[n("button",{class:"modal-close",onClick:o[0]||(o[0]=k=>i("close"))},"✖"),n("div",J,[o[8]||(o[8]=n("header",{class:"modal-header"},[n("h2",null,"Informativa Privacy")],-1)),n("div",W,[o[5]||(o[5]=n("h3",null,"Titolare del trattamento",-1)),n("p",null,u(t(a)[33])+" - "+u(t(a)[38])+" - "+u(t(a)[35])+" - "+u(t(a)[34]),1),o[6]||(o[6]=O("<h3 data-v-721d4047>Dati raccolti</h3><p data-v-721d4047>Per l’iscrizione agli eventi vengono richiesti:</p><ul data-v-721d4047><li data-v-721d4047>Nome</li><li data-v-721d4047>Cognome</li><li data-v-721d4047>Numero di cellulare</li></ul><h3 data-v-721d4047>Finalità del trattamento</h3><p data-v-721d4047>I dati sono utilizzati esclusivamente per:</p><ul data-v-721d4047><li data-v-721d4047>Gestire le iscrizioni agli eventi</li><li data-v-721d4047>Contattare gli iscritti per comunicazioni relative all’evento</li></ul><h3 data-v-721d4047>Base giuridica</h3><p data-v-721d4047>Il trattamento è necessario per l’esecuzione del servizio richiesto (art. 6.1.b GDPR).</p><h3 data-v-721d4047>Modalità di trattamento</h3><p data-v-721d4047>I dati sono trattati solo dal titolare e non vengono condivisi con terzi. Sono memorizzati in formato elettronico, con misure di sicurezza adeguate.</p><h3 data-v-721d4047>Conservazione</h3><p data-v-721d4047>I dati saranno conservati di norma per un massimo di 12 mesi dalla conclusione dell’evento e comunque per il tempo strettamente necessario alla gestione delle iscrizioni. Successivamente verranno cancellati o resi anonimi.</p>",12)),l.pagamenti?(r(),c("h3",X,"Cookie tecnici necessari")):m("",!0),l.pagamenti?(r(),c("p",Y," Questo sito utilizza esclusivamente cookie tecnici indispensabili al corretto funzionamento del sistema di iscrizione e pagamento. In particolare, viene salvato un identificativo cifrato (payment id) che consente di associare il dispositivo alla richiesta di pagamento tramite Satispay. Senza questo cookie il servizio non può funzionare correttamente. Il cookie non contiene dati personali identificativi e viene eliminato automaticamente al termine della sessione o entro breve tempo dalla conclusione del pagamento. Non vengono utilizzati cookie di profilazione o di tracciamento. ")):m("",!0),l.pagamenti?(r(),c("h3",Z,"Pagamenti")):m("",!0),l.pagamenti?(r(),c("p",ee,o[2]||(o[2]=[y("I pagamenti online sono gestiti tramite Satispay, che tratta i dati di pagamento come titolare autonomo. Noi non raccogliamo né conserviamo dati relativi ai mezzi di pagamento. Riceviamo solo le informazioni necessarie per confermare il pagamento. "),n("a",{href:"https://www.satispay.com/it-it/legal-hub/privacy/",target:"_blank",rel:"noopener"},"Informativa Satispay",-1),y(". ")]))):m("",!0),o[7]||(o[7]=n("h3",null,"Diritti dell’interessato",-1)),n("p",null,[y("Puoi chiedere in qualsiasi momento l’accesso, la rettifica o la cancellazione dei dati scrivendo a "+u(t(a)[35])+" o al "+u(t(a)[34])+" È inoltre possibile proporre reclamo al Garante per la protezione dei dati personali (",1),o[3]||(o[3]=n("a",{href:"https://www.garanteprivacy.it",target:"_blank",rel:"noopener"},"www.garanteprivacy.it",-1)),o[4]||(o[4]=y(")."))])])])])])):m("",!0)}},ie=$(te,[["__scopeId","data-v-721d4047"]]),oe={key:1},ae={class:"privacy"},ne={class:"costo"},le={key:0,type:"submit",class:"btn"},se={key:1,class:"btn btn-satispay",type:"submit"},re={__name:"iscrizione",setup(z){const v=K(),a=_(!v.query.id),i=q({title:"",msg:"",link:"",linkMsg:""}),l=_(null),s=q({nome:"",cognome:"",cellulare:"",privacy:!1}),o=_(!1);M({title:"Iscrizione"}),a.value||T("https://bertolotti.ct.ws/getEvento?getPostiDisponibili&minimal&id="+v.query.id).then(function(p){if(!p.ok)a.value=!0,i.msg=p.msg;else{M({title:"Iscrizione a "+p.evento.Titolo});const e=new Date().toISOString().split("T")[0];l.value=p.evento,p.posti<1?(a.value=!0,i.title="Sold out!",i.msg="Ci dispiace ma non ci sono più posti disponibili!",i.linkMsg="Vai agli eventi",i.link="/eventi"):e>l.value.Data?(a.value=!0,i.title="Troppo tardi!",i.msg="Ci dispiace ma non ci si può iscrivere ad un evento passato",i.linkMsg="Vai agli eventi",i.link="/eventi"):(e>l.value.ScadenzaIscrizione||e>l.value.Data)&&(a.value=!0,i.title="Troppo tardi!",i.msg="Ci dispiace ma il termine delle iscrizioni è già passato!",i.linkMsg="Vai agli eventi",i.link="/eventi")}});async function k(){if(!s.privacy){alert("Devi accettare l'informativa privacy per procedere.");return}const p={idEvento:v.query.id,cellulare:s.cellulare,cognome:s.cognome,nome:s.nome};let e=await j("https://bertolotti.ct.ws/iscrivi",p);e.ok?e.paymentAccepted||e.alreadySubscribed?(a.value=!0,i.msg=e.msg,i.title="Già iscritto!"):e.redirectTo=="/success"?(a.value=!0,i.msg=`Iscrizione avvenuta con successo!
È stato riservato un posto per te per `+l.value.Titolo+" in data "+A(l.value.Data),i.title="Ottimo!"):window.location.href=e.redirectTo+"?id="+v.query.id:(a.value=!0,i.msg=e.msg,i.link="/iscrizione?id="+v.query.id,i.linkMsg="Riprova ad iscriverti")}return(p,e)=>{var I,C,V,S,D,x;const w=G,N=H,f=U,P=F,B=ie,R=Q;return r(),c(L,null,[g(w),t(a)?m("",!0):(r(),b(N,{key:0})),t(a)?m("",!0):(r(),c("main",oe,[n("section",null,[n("h1",null,"Iscriviti a "+u((I=t(l))==null?void 0:I.Titolo),1),n("form",{onSubmit:e[5]||(e[5]=h(d=>k(),["prevent"]))},[g(f,{label:"Nome",modelValue:t(s).nome,"onUpdate:modelValue":e[0]||(e[0]=d=>t(s).nome=d),required:""},null,8,["modelValue"]),g(f,{label:"Cognome",modelValue:t(s).cognome,"onUpdate:modelValue":e[1]||(e[1]=d=>t(s).cognome=d),required:""},null,8,["modelValue"]),g(f,{label:"Cellulare",modelValue:t(s).cellulare,"onUpdate:modelValue":e[2]||(e[2]=d=>t(s).cellulare=d),type:"tel",required:""},null,8,["modelValue"]),n("div",ae,[g(f,{type:"checkbox",placeholder:"Ho letto e accetto l’informativa privacy relativa all’iscrizione "+(((C=t(l))==null?void 0:C.Costo)>0?"e al pagamento":"")+" dell’evento",required:"",modelValue:t(s).privacy,"onUpdate:modelValue":e[3]||(e[3]=d=>t(s).privacy=d)},null,8,["placeholder","modelValue"]),n("a",{href:"#",onClick:e[4]||(e[4]=h(d=>o.value=!0,["prevent"])),class:"privacy-link"}," Leggi informativa ")]),n("div",null,[n("p",ne,[e[7]||(e[7]=y(" Costo:  ")),n("b",null,u(((V=t(l))==null?void 0:V.Costo)>0?((S=t(l))==null?void 0:S.Costo)+"€":"GRATIS"),1)]),((D=t(l))==null?void 0:D.Costo)==0?(r(),c("button",le,"Iscriviti")):(r(),c("button",se,e[8]||(e[8]=[y(" Satispay "),n("img",{src:"https://bertolotti.ct.ws/satispay.jpg",alt:"Satispay logo"},null,-1)])))])],32)]),g(P)])),t(a)?m("",!0):(r(),b(B,{key:2,show:t(o),pagamenti:((x=t(l))==null?void 0:x.Costo)>0,onClose:e[6]||(e[6]=d=>o.value=!1)},null,8,["show","pagamenti"])),t(a)?(r(),b(R,{key:3,obj:t(i)},null,8,["obj"])):m("",!0),g(w,{show:!t(a)&&!t(l)},null,8,["show"])],64)}}},ge=$(re,[["__scopeId","data-v-788d9e13"]]);export{ge as default};
